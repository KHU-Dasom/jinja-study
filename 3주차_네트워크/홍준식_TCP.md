# TCP(Transmission Control Protocol)
TCP (전송 제어 프로토콜)은 두 개의 호스트를 연결하고 데이터 스트림을 교환하게 해주는 네트워크 4계층 프로토콜이다.  
네트워크 4계층 프로토콜로는 TCP, UDP, QUIC 등이 존재한다.  

TCP는 데이터와 패킷이 보내진 순서대로 전달되고 손실되지 않는 것을 보장해준다.  

# 오류 제어
훼손된 패킷 감지 및 중복 수신한 패킷 폐기, 순서에 맞지 않는 세그먼트 버퍼 저장 및 손실된 패킷 재전송 처리를 한다.  
### Check Sum
![체크섬](https://www.researchgate.net/publication/11818463/figure/fig3/AS:267679265194001@1440831118287/TCP-checksuma-The-checksum-is-a-simple-function-performed-by-all-web-servers-in-TCP.png)  
오류 제어 방식으로 Pesudo Header, TCP Segment의 모든 값을 16비트로 나누고 각각의 합마다 발생하는 carry를 다시 계산 결과에 더한다. 이러한 방식을 차례대로 반복하고 마지막 결과에 1의 보수를 취해 주면 Check Sum이 된다.  
값이 정상적으로 들어왔는지를 확인할 수 있다.  
### Acknowledgement
![TCP ACK](https://i0.wp.com/madpackets.com/wp-content/uploads/2018/04/tcp-seq-ack-flow-e1524681839913.png?resize=538%2C756&ssl=1)  
TCP는 모든 응답에 메세지를 정상적으로 수신했고, 다음 응답을 송신해도 된다는 것을 알리기 위하여 ACK를 전달하다.  
다음에 수신하기를 기대하는 Sequence 번호를 ACK 한다.  
### Time Out
TCP는 항상 RTO(Retransmission time out) 타이머를 모든 전송에 대해서 설정한다.  
만약 타이머가 종료되면, 가장 최근 세그먼트를 재전송한다.  
이 RTO 값은 동적으로 segment의 RTT(Round Trip TIme)에 의하여 변경된다.  
RTT는 세그먼트가 수신자에 도달하고 해당 ACK가 송신자에 다시 도달할 때 까지의 시간이다.  

3번 동일한 ACK를 수신하거나 Time Out이 발생하면 송신자는 패킷을 재전송한다.

# 흐름 제어
송신과 수신측의 데이터 처리 속도 차이를 해결하기 위한 기법 (수신 측이 수용 가능한 만큼의 패킷만 수신하도록 함)  
수신 측이 송신측에 계속 자신의 상태를 알리는 방법이다.  

![TCP 버퍼](https://www.brianstorti.com/assets/images/tcp-flow-control/buffers.png)  
TCP는 송신 버퍼에 송신할 데이터를 저장하고, 수신 버퍼에 있는 데이터를 읽어들인다. 어플리케이션이 준비가 되었을 때에, 수신 버퍼에서 데이터를 읽어들인다.  
여기서 흐름 제어란 수신 버퍼가 꽉 찼을 때 더이상 패킷을 전송하지 않아 수신 버퍼가 패킷을 손실하지 않도록 하는 것이다.    
TCP가 송신할 수 있는 데이터의 양을 제어하기 위해서 수신자는 `Recieve Window (rwnd)`를 홍보한다.  
매번 TCP가 패킷을 수신할 때에 수신자는 패킷을 정확히 수신했다는 것을 알리기 위하여 `ack` 메세지를 송신자에게 전송해야한다. 이 `ack`메세지에 최근 `receive window`의 값을 전달하여 계속 데이터를 송신할 수 있을지 알린다.  

### Stop And Wait
![stop and wait](https://static.javatpoint.com/tutorial/computer-network/images/stop-and-wait-protocol.png)  
전송한 패킷에 대한 응답을 받아야만 다음 패킷을 전송한다.  
### Sliding Window

![슬라이딩 윈도우](data:image/jpeg;base64,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)  
```
LastByteSent - LastByteAcked <= ReceivecWindowAdvertised
```
만약 150,000 바이트의 파일을 A -> B 로 전송하려한다고 하자.  
이것을 각각 1,500 바이트의 100개의 패킷으로 분리한다.  
A와 B의 `3 way handshake` 과정에서 B는 A에게 45,000 바이트의 receive window가 존재한다고 홍보한다.  
최초에 A는 30(1,500 * 30 = 45,000)개의 패킷을 B에 전송한다.  
B는 A에 10개의 패킷을 수신했다고 ack를 전송한다.  
A는 receive window의 크기가 45,000 바이트라는 것을 알기에 다음 10개의 패킷을 전송한다.  
만약 몇가지 원인으로 B의 어플리케이션의 패킷을 읽는 속도가 느려지고 receive window가 작아질 수 있다.  
만약 receive window가 30,000 바이트로 줄어들면, 이후 송신 측은 가장 최근의 receive window 크기만큼(30,000 바이트)만 데이터를 전송한다.  

TCP는 주로 슬라이딩 윈도우를 사용한다.  
- 수신 가능한 패킷의 양을 예측 가능하다.  
- 한번에 여러 패킷을 전송할 수 있다.  
- 윈도우 크기를 유연하게 조절할 수 있다.  
는 장점이 존재한다.  

# 혼잡 제어
송신과 수신측의 네트워크 데이터 처리량을 조절하기 위한 기법  
통신하는 데이터의 양이 라우터가 처리할 수 있는 양을 초과하면 데이터가 손실된다.  
데이터 양을 조절하기 위하여 전송 속도를 조절한다.  

### AIMD (Additive Increase / Multicative Decrease)
합 증가 / 곱 감소 방식  
패킷 전송에 성공하면 윈도우의 크기를 1씩 증가시키고 실패하면 윈도우의 크기를 절반으로 줄인다.  
윈도우 크기 증가 속도가 너무 느리다는 단점이 존재한다.  
### Slow Start
윈도우의 크기를 지수적으로 증가시키고 패킷이 실패하면 윈도우의 크기를 1로 줄인다.  
### Tahoe
![Tahoe](https://media.geeksforgeeks.org/wp-content/uploads/20220202201117/tahoecongestionwindow1.png)  
초기에 Slow Start를 사용하다가 임계값을 넘어가면 AIMD 방식으로 전환 (Fast Retransmit)  
sshthresh(slow start threshold) 값을 `3 ACK Duplicated (3번 이상 중복된 ack 번호를 받는 경우)`나 `Timeout`이 발생하는 경우 sshthresh 값을 발생한 윈도우 크기의 절반으로 줄인다.
### Reno
![레노](https://media.geeksforgeeks.org/wp-content/uploads/20220202203124/Renocongestionwindow.png)  
3 ACK Duplicated의 경우 ACK를 수신하므로 Timeout에 비하여 큰 혼잡이 아니라고 가정한다.  
Tahoe 에서 3 ACK Duplicated의 경우 윈도우 크기를 절반으로 설정하고 sshthresh 값을 줄어든 윈도우 값으로 설정한다. (Fast Recovery)  





# TCP 3 Way Handshake
서버와 클라이언트 간의 논리적인 접속을 성립하기 위해 3 way handshake를 진행한다.
![3 way handshake](https://media.geeksforgeeks.org/wp-content/uploads/TCP-connection-1.png)  
1. SYN(클라이언트 -> 서버): 클라이언트는 서버에 연결을 성립하고 싶다는 SYN(Syncvhronize Sequence Number)를 보내 특정 세그먼트 번호(Initial Sequence Number)로 연결을 시작하고 싶다고 요청한다.  
2. SYN + ACK(서버 -> 클라이언트): ACK는 SYN에 대한 응답이고 서버 또한 자신의 sequence number를 클라이언트에 알리는 SYN을 보낸다.
3. ACK(클라이언트 -> 서버): 연결이 잘 맺어졌고 이후 데이터를 보내게 된다.

# TCP 4 Way Handshake
![TCP 4 way handshake](https://media.geeksforgeeks.org/wp-content/uploads/CN.png)  
1. FIN(클라이언트 -> 서버): 서버에 FIN bit를 1로 설정하여 연결을 종료하고싶다는 요청을 보낸다.
2. ACK(서버 -> 클라이언트)
3. FIN(서버 -> 클라이언트): ACK를 보낸 후 서버와 연결을 종료할 준비가 되면 FIN 요청을 보낸다.
4. ACK(클라이언트 -> 서버)

# 참조
- https://www.brianstorti.com/tcp-flow-control/  
- https://gyoogle.dev/blog/computer-science/network/흐름제어%20&%20혼잡제어.html  
- https://www.ibm.com/docs/en/tsm/7.1.0?topic=tuning-tcp-flow-control-sliding-window  
- https://www.geeksforgeeks.org/tcp-tahoe-and-tcp-reno/  
- https://www.geeksforgeeks.org/error-control-in-tcp/  
